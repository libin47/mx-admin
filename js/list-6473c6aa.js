import{f as d,R as r,u as x,t as k,j as D,w as R,m as T,p as F,a as t,C as N,F as C,A as B,s as p,d as S,N as m,b as i}from"./index-8eac1ff4.js";import{D as b}from"./delete-confirm-bdba8da5.js";import{T as A}from"./index-edb3ff22.js";import{R as L}from"./relative-time-8690a9cd.js";import{u as M}from"./use-table-7eba66f5.js";import{H as K}from"./rounded-button-b07f86c3.js";import{N as P}from"./Popconfirm-e332df69.js";import"./DataTable-f6ed0843.js";import"./ChevronRight-bef4a6be.js";import"./Checkbox-2ecdd3a4.js";import"./index-2488235d.js";import"./Icon-2092b1d2.js";import"./prop-46b62c35.js";import"./Select-e56a7f39.js";import"./Tag-f56d7815.js";import"./Forward-6182c0eb.js";import"./Tooltip-2f77c19b.js";const te=d({name:"SayList",setup(V,$){const{checkedRowKeys:o,data:y,pager:n,loading:f,fetchDataFn:g}=M((a,e)=>async(v=l.query.page||1,w=30)=>{const c=await r.api.says.get({params:{page:v,size:w,select:"title text _id id created modified author source"}});a.value=c.data,e.value=c.pagination}),u=x();k();const l=D(),s=g;R(()=>l.query.page,async a=>{await s(a)}),T(async()=>{await s()});const h=d({setup(){const a=F([{type:"selection",options:["none","all"]},{title:"\u521B\u5EFA\u4E8E",key:"created",width:100,render(e){return t(p,{to:`/says/edit?id=${e.id}`},{default:()=>[t(L,{time:e.created},null)]})}},{title:"\u5185\u5BB9",key:"text"},{title:"\u4F5C\u8005",key:"author"},{title:"\u6765\u6E90",key:"source"},{title:"\u64CD\u4F5C",fixed:"right",key:"id",width:130,render(e){return t(S,{wrap:!1},{default:()=>[t(p,{to:`/says/edit?id=${e.id}`},{default:()=>[t(m,{text:!0,type:"primary",size:"tiny"},{default:()=>[i("\u7F16\u8F91")]})]}),t(P,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:async()=>{await r.api.says(e.id).delete(),u.success("\u5220\u9664\u6210\u529F"),await s(n.value.currentPage)}},{trigger:()=>t(m,{text:!0,type:"error",size:"tiny"},{default:()=>[i("\u79FB\u9664")]}),default:()=>t("span",{class:"max-w-48"},[i("\u786E\u5B9A\u8981\u5220\u9664\u201C"),e.text,i("\u201D ?")])})]})}}]);return()=>t(A,{loading:f.value,columns:a,data:y,onFetchData:s,pager:n,onUpdateCheckedRowKeys:e=>{o.value=e}},null)}});return()=>t(N,null,{actions:()=>t(C,null,[t(b,{checkedRowKeys:o.value,onDelete:async()=>{const a=await Promise.allSettled(o.value.map(e=>r.api.says(e).delete()));for(const e of a)e.status==="rejected"&&u.success(`\u5220\u9664\u5931\u8D25\uFF0C${e.reason.message}`);o.value.length=0,s()}},null),t(K,{to:"/says/edit",icon:t(B,null,null)},null)]),default:()=>t(h,null,null)})}});export{te as default};

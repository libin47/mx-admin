import{f as L,o as tt,h as nt,i as D,y as B,br as Ct,w as et,a as d,H as vt,c4 as Z,bZ as ft,c5 as j,p as bt,N as Tt,I as K,M as It,c6 as Nt,b as Q,c3 as yt,F as Lt,c7 as Pt,n as kt,c8 as Vt,c9 as Ft,b_ as Bt,c1 as Dt,c2 as jt,c0 as St,E as zt}from"./index-234d295e.js";import{u as ct}from"./use-react-ee5539fc.js";import{u as Rt}from"./use-save-confirm-f5cd5494.js";import{t as mt}from"./throttle-6012207b.js";import{N as U}from"./FormItem-44e68381.js";import{N as Ut}from"./InputNumber-ca28412d.js";import{N as $t}from"./Form-d7b36f72.js";import{N as Gt}from"./Select-6f927681.js";const Wt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ht=D("path",{d:"M256 48C141.31 48 48 141.32 48 256c0 114.86 93.14 208 208 208c114.69 0 208-93.31 208-208c0-114.87-93.13-208-208-208zm0 313a94 94 0 0 1 0-188h4.21l-14.11-14.1a14 14 0 0 1 19.8-19.8l40 40a14 14 0 0 1 0 19.8l-40 40a14 14 0 0 1-19.8-19.8l18-18c-2.38-.1-5.1-.1-8.1-.1a66 66 0 1 0 66 66a14 14 0 0 1 28 0a94.11 94.11 0 0 1-94 94z",fill:"currentColor"},null,-1),qt=[Ht];var Jt=L({name:"RefreshCircle",render:function(t,n){return tt(),nt("svg",Wt,qt)}});const Yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Zt=D("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z",fill:"currentColor"},null,-1),Kt=[Zt];var Qt=L({name:"FullscreenExitOutlined",render:function(t,n){return tt(),nt("svg",Yt,Kt)}});const Xt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},tn=D("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[D("path",{d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37c1 .608 2.296.07 2.572-1.065z"}),D("circle",{cx:"12",cy:"12",r:"3"})],-1),nn=[tn];var en=L({name:"Settings",render:function(t,n){return tt(),nt("svg",Xt,nn)}});const xt={editor:"editor-pref",general:"editor-general"};var P=(r=>(r.monaco="monaco",r.codemirror="codemirror",r.plain="plain",r))(P||{});const rn="_editor_19kch_1",on="_loading_19kch_1";var $={editor:rn,loading:on};const rt={text:{type:String,required:!0},onChange:{type:Function,required:!0},unSaveConfirm:{type:Boolean,default:!0}},lt=L({props:{...rt,wrapperProps:{type:Object,required:!1}},setup(r){const t=B();let n=Ct(r.text);return et(()=>r.text,e=>{!n&&e&&(n=e)}),Rt(r.unSaveConfirm,()=>n===r.text),()=>d("div",r.wrapperProps,[d(vt,{ref:t,type:"textarea",onInput:e=>void r.onChange(e),value:r.text,class:"h-full"},null)])}}),F={[P.monaco]:null,[P.plain]:null,[P.codemirror]:null},H=r=>{if(F[r])return F[r];switch(r){case"monaco":{const t=Z({loader:()=>ft(()=>import("./monaco-811f7a0f.js"),["js/monaco-811f7a0f.js","js/index-234d295e.js","assets/index.0850f119.css","js/index-6dc67fce.js","js/use-save-confirm-f5cd5494.js","js/use-react-ee5539fc.js","js/throttle-6012207b.js","js/FormItem-44e68381.js","js/Form-d7b36f72.js","js/index-0002da5a.js","js/InputNumber-ca28412d.js","js/Add-a1ac92d9.js","js/Select-6f927681.js","js/Tag-38ffd993.js"]).then(n=>n.MonacoEditor),loadingComponent:d(j,{strokeWidth:14,show:!0,rotate:!0},null),suspensible:!0});return F[r]=t,t}case"plain":return F[r]=lt,lt;case"codemirror":{const t=Z({loader:()=>ft(()=>import("./codemirror-d1360320.js").then(function(n){return n.m}),["js/codemirror-d1360320.js","assets/codemirror.75ec60a4.css","js/index-234d295e.js","assets/index.0850f119.css","js/use-save-confirm-f5cd5494.js"]).then(n=>n.CodemirrorEditor),loadingComponent:d(j,{strokeWidth:14,show:!0,rotate:!0},null),suspensible:!0});return F[r]=t,t}default:return null}};var g;(function(r){r[r.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",r[r.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",r[r.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(g||(g={}));var sn=function(){function r(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return r.prototype.addTypeMetadata=function(t){this._typeMetadatas.has(t.target)||this._typeMetadatas.set(t.target,new Map),this._typeMetadatas.get(t.target).set(t.propertyName,t)},r.prototype.addTransformMetadata=function(t){this._transformMetadatas.has(t.target)||this._transformMetadatas.set(t.target,new Map),this._transformMetadatas.get(t.target).has(t.propertyName)||this._transformMetadatas.get(t.target).set(t.propertyName,[]),this._transformMetadatas.get(t.target).get(t.propertyName).push(t)},r.prototype.addExposeMetadata=function(t){this._exposeMetadatas.has(t.target)||this._exposeMetadatas.set(t.target,new Map),this._exposeMetadatas.get(t.target).set(t.propertyName,t)},r.prototype.addExcludeMetadata=function(t){this._excludeMetadatas.has(t.target)||this._excludeMetadatas.set(t.target,new Map),this._excludeMetadatas.get(t.target).set(t.propertyName,t)},r.prototype.findTransformMetadatas=function(t,n,e){return this.findMetadatas(this._transformMetadatas,t,n).filter(function(o){return!o.options||o.options.toClassOnly===!0&&o.options.toPlainOnly===!0?!0:o.options.toClassOnly===!0?e===g.CLASS_TO_CLASS||e===g.PLAIN_TO_CLASS:o.options.toPlainOnly===!0?e===g.CLASS_TO_PLAIN:!0})},r.prototype.findExcludeMetadata=function(t,n){return this.findMetadata(this._excludeMetadatas,t,n)},r.prototype.findExposeMetadata=function(t,n){return this.findMetadata(this._exposeMetadatas,t,n)},r.prototype.findExposeMetadataByCustomName=function(t,n){return this.getExposedMetadatas(t).find(function(e){return e.options&&e.options.name===n})},r.prototype.findTypeMetadata=function(t,n){return this.findMetadata(this._typeMetadatas,t,n)},r.prototype.getStrategy=function(t){var n=this._excludeMetadatas.get(t),e=n&&n.get(void 0),o=this._exposeMetadatas.get(t),i=o&&o.get(void 0);return e&&i||!e&&!i?"none":e?"excludeAll":"exposeAll"},r.prototype.getExposedMetadatas=function(t){return this.getMetadata(this._exposeMetadatas,t)},r.prototype.getExcludedMetadatas=function(t){return this.getMetadata(this._excludeMetadatas,t)},r.prototype.getExposedProperties=function(t,n){return this.getExposedMetadatas(t).filter(function(e){return!e.options||e.options.toClassOnly===!0&&e.options.toPlainOnly===!0?!0:e.options.toClassOnly===!0?n===g.CLASS_TO_CLASS||n===g.PLAIN_TO_CLASS:e.options.toPlainOnly===!0?n===g.CLASS_TO_PLAIN:!0}).map(function(e){return e.propertyName})},r.prototype.getExcludedProperties=function(t,n){return this.getExcludedMetadatas(t).filter(function(e){return!e.options||e.options.toClassOnly===!0&&e.options.toPlainOnly===!0?!0:e.options.toClassOnly===!0?n===g.CLASS_TO_CLASS||n===g.PLAIN_TO_CLASS:e.options.toPlainOnly===!0?n===g.CLASS_TO_PLAIN:!0}).map(function(e){return e.propertyName})},r.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},r.prototype.getMetadata=function(t,n){var e=t.get(n),o;e&&(o=Array.from(e.values()).filter(function(f){return f.propertyName!==void 0}));for(var i=[],s=0,u=this.getAncestors(n);s<u.length;s++){var l=u[s],a=t.get(l);if(a){var p=Array.from(a.values()).filter(function(f){return f.propertyName!==void 0});i.push.apply(i,p)}}return i.concat(o||[])},r.prototype.findMetadata=function(t,n,e){var o=t.get(n);if(o){var i=o.get(e);if(i)return i}for(var s=0,u=this.getAncestors(n);s<u.length;s++){var l=u[s],a=t.get(l);if(a){var p=a.get(e);if(p)return p}}},r.prototype.findMetadatas=function(t,n,e){var o=t.get(n),i;o&&(i=o.get(e));for(var s=[],u=0,l=this.getAncestors(n);u<l.length;u++){var a=l[u],p=t.get(a);p&&p.has(e)&&s.push.apply(s,p.get(e))}return s.slice().reverse().concat((i||[]).slice().reverse())},r.prototype.getAncestors=function(t){if(!t)return[];if(!this._ancestorsMap.has(t)){for(var n=[],e=Object.getPrototypeOf(t.prototype.constructor);typeof e.prototype<"u";e=Object.getPrototypeOf(e.prototype.constructor))n.push(e);this._ancestorsMap.set(t,n)}return this._ancestorsMap.get(t)},r}(),_=new sn;function an(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}function un(r){return r!==null&&typeof r=="object"&&typeof r.then=="function"}var pt=globalThis&&globalThis.__spreadArray||function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,i;e<o;e++)(i||!(e in t))&&(i||(i=Array.prototype.slice.call(t,0,e)),i[e]=t[e]);return r.concat(i||Array.prototype.slice.call(t))};function fn(r){var t=new r;return!(t instanceof Set)&&!("push"in t)?[]:t}var k=function(){function r(t,n){this.transformationType=t,this.options=n,this.recursionStack=new Set}return r.prototype.transform=function(t,n,e,o,i,s){var u=this;if(s===void 0&&(s=0),Array.isArray(n)||n instanceof Set){var l=o&&this.transformationType===g.PLAIN_TO_CLASS?fn(o):[];return n.forEach(function(v,A){var w=t?t[A]:void 0;if(!u.options.enableCircularCheck||!u.isCircular(v)){var x=void 0;if(typeof e!="function"&&e&&e.options&&e.options.discriminator&&e.options.discriminator.property&&e.options.discriminator.subTypes){if(u.transformationType===g.PLAIN_TO_CLASS){x=e.options.discriminator.subTypes.find(function(O){return O.name===v[e.options.discriminator.property]});var C={newObject:l,object:v,property:void 0},h=e.typeFunction(C);x===void 0?x=h:x=x.value,e.options.keepDiscriminatorProperty||delete v[e.options.discriminator.property]}u.transformationType===g.CLASS_TO_CLASS&&(x=v.constructor),u.transformationType===g.CLASS_TO_PLAIN&&(v[e.options.discriminator.property]=e.options.discriminator.subTypes.find(function(O){return O.value===v.constructor}).name)}else x=e;var S=u.transform(w,v,x,void 0,v instanceof Map,s+1);l instanceof Set?l.add(S):l.push(S)}else u.transformationType===g.CLASS_TO_CLASS&&(l instanceof Set?l.add(v):l.push(v))}),l}else{if(e===String&&!i)return n==null?n:String(n);if(e===Number&&!i)return n==null?n:Number(n);if(e===Boolean&&!i)return n==null?n:Boolean(n);if((e===Date||n instanceof Date)&&!i)return n instanceof Date?new Date(n.valueOf()):n==null?n:new Date(n);if(!!an().Buffer&&(e===Buffer||n instanceof Buffer)&&!i)return n==null?n:Buffer.from(n);if(un(n)&&!i)return new Promise(function(v,A){n.then(function(w){return v(u.transform(void 0,w,e,void 0,void 0,s+1))},A)});if(!i&&n!==null&&typeof n=="object"&&typeof n.then=="function")return n;if(typeof n=="object"&&n!==null){!e&&n.constructor!==Object&&(!Array.isArray(n)&&n.constructor===Array||(e=n.constructor)),!e&&t&&(e=t.constructor),this.options.enableCircularCheck&&this.recursionStack.add(n);var a=this.getKeys(e,n,i),p=t||{};!t&&(this.transformationType===g.PLAIN_TO_CLASS||this.transformationType===g.CLASS_TO_CLASS)&&(i?p=new Map:e?p=new e:p={});for(var f=function(v){if(v==="__proto__"||v==="constructor")return"continue";var A=v,w=v,x=v;if(!c.options.ignoreDecorators&&e){if(c.transformationType===g.PLAIN_TO_CLASS){var C=_.findExposeMetadataByCustomName(e,v);C&&(x=C.propertyName,w=C.propertyName)}else if(c.transformationType===g.CLASS_TO_PLAIN||c.transformationType===g.CLASS_TO_CLASS){var C=_.findExposeMetadata(e,v);C&&C.options&&C.options.name&&(w=C.options.name)}}var h=void 0;c.transformationType===g.PLAIN_TO_CLASS?h=n[A]:n instanceof Map?h=n.get(A):n[A]instanceof Function?h=n[A]():h=n[A];var S=void 0,O=h instanceof Map;if(e&&i)S=e;else if(e){var y=_.findTypeMetadata(e,x);if(y){var W={newObject:p,object:n,property:x},z=y.typeFunction?y.typeFunction(W):y.reflectedType;y.options&&y.options.discriminator&&y.options.discriminator.property&&y.options.discriminator.subTypes?n[A]instanceof Array?S=y:(c.transformationType===g.PLAIN_TO_CLASS&&(S=y.options.discriminator.subTypes.find(function(N){if(h&&h instanceof Object&&y.options.discriminator.property in h)return N.name===h[y.options.discriminator.property]}),S===void 0?S=z:S=S.value,y.options.keepDiscriminatorProperty||h&&h instanceof Object&&y.options.discriminator.property in h&&delete h[y.options.discriminator.property]),c.transformationType===g.CLASS_TO_CLASS&&(S=h.constructor),c.transformationType===g.CLASS_TO_PLAIN&&h&&(h[y.options.discriminator.property]=y.options.discriminator.subTypes.find(function(N){return N.value===h.constructor}).name)):S=z,O=O||y.reflectedType===Map}else if(c.options.targetMaps)c.options.targetMaps.filter(function(N){return N.target===e&&!!N.properties[x]}).forEach(function(N){return S=N.properties[x]});else if(c.options.enableImplicitConversion&&c.transformationType===g.PLAIN_TO_CLASS){var ot=Reflect.getMetadata("design:type",e.prototype,x);ot&&(S=ot)}}var st=Array.isArray(n[A])?c.getReflectedType(e,x):void 0,at=t?t[A]:void 0;if(p.constructor.prototype){var ut=Object.getOwnPropertyDescriptor(p.constructor.prototype,w);if((c.transformationType===g.PLAIN_TO_CLASS||c.transformationType===g.CLASS_TO_CLASS)&&(ut&&!ut.set||p[w]instanceof Function))return"continue"}if(!c.options.enableCircularCheck||!c.isCircular(h)){var R=c.transformationType===g.PLAIN_TO_CLASS?w:v,m=void 0;c.transformationType===g.CLASS_TO_PLAIN?(m=n[R],m=c.applyCustomTransformations(m,e,R,n,c.transformationType),m=n[R]===m?h:m,m=c.transform(at,m,S,st,O,s+1)):h===void 0&&c.options.exposeDefaultValues?m=p[w]:(m=c.transform(at,h,S,st,O,s+1),m=c.applyCustomTransformations(m,e,R,n,c.transformationType)),(m!==void 0||c.options.exposeUnsetFields)&&(p instanceof Map?p.set(w,m):p[w]=m)}else if(c.transformationType===g.CLASS_TO_CLASS){var m=h;m=c.applyCustomTransformations(m,e,v,n,c.transformationType),(m!==void 0||c.options.exposeUnsetFields)&&(p instanceof Map?p.set(w,m):p[w]=m)}},c=this,E=0,T=a;E<T.length;E++){var I=T[E];f(I)}return this.options.enableCircularCheck&&this.recursionStack.delete(n),p}else return n}},r.prototype.applyCustomTransformations=function(t,n,e,o,i){var s=this,u=_.findTransformMetadatas(n,e,this.transformationType);return this.options.version!==void 0&&(u=u.filter(function(l){return l.options?s.checkVersion(l.options.since,l.options.until):!0})),this.options.groups&&this.options.groups.length?u=u.filter(function(l){return l.options?s.checkGroups(l.options.groups):!0}):u=u.filter(function(l){return!l.options||!l.options.groups||!l.options.groups.length}),u.forEach(function(l){t=l.transformFn({value:t,key:e,obj:o,type:i,options:s.options})}),t},r.prototype.isCircular=function(t){return this.recursionStack.has(t)},r.prototype.getReflectedType=function(t,n){if(!!t){var e=_.findTypeMetadata(t,n);return e?e.reflectedType:void 0}},r.prototype.getKeys=function(t,n,e){var o=this,i=_.getStrategy(t);i==="none"&&(i=this.options.strategy||"exposeAll");var s=[];if((i==="exposeAll"||e)&&(n instanceof Map?s=Array.from(n.keys()):s=Object.keys(n)),e)return s;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&t){var u=_.getExposedProperties(t,this.transformationType),l=_.getExcludedProperties(t,this.transformationType);s=pt(pt([],u,!0),l,!0)}if(!this.options.ignoreDecorators&&t){var u=_.getExposedProperties(t,this.transformationType);this.transformationType===g.PLAIN_TO_CLASS&&(u=u.map(function(f){var c=_.findExposeMetadata(t,f);return c&&c.options&&c.options.name?c.options.name:f})),this.options.excludeExtraneousValues?s=u:s=s.concat(u);var a=_.getExcludedProperties(t,this.transformationType);a.length>0&&(s=s.filter(function(f){return!a.includes(f)})),this.options.version!==void 0&&(s=s.filter(function(f){var c=_.findExposeMetadata(t,f);return!c||!c.options?!0:o.checkVersion(c.options.since,c.options.until)})),this.options.groups&&this.options.groups.length?s=s.filter(function(f){var c=_.findExposeMetadata(t,f);return!c||!c.options?!0:o.checkGroups(c.options.groups)}):s=s.filter(function(f){var c=_.findExposeMetadata(t,f);return!c||!c.options||!c.options.groups||!c.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(s=s.filter(function(p){return o.options.excludePrefixes.every(function(f){return p.substr(0,f.length)!==f})})),s=s.filter(function(p,f,c){return c.indexOf(p)===f}),s},r.prototype.checkVersion=function(t,n){var e=!0;return e&&t&&(e=this.options.version>=t),e&&n&&(e=this.options.version<n),e},r.prototype.checkGroups=function(t){return t?this.options.groups.some(function(n){return t.includes(n)}):!0},r}(),V={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},M=globalThis&&globalThis.__assign||function(){return M=Object.assign||function(r){for(var t,n=1,e=arguments.length;n<e;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},M.apply(this,arguments)},cn=function(){function r(){}return r.prototype.instanceToPlain=function(t,n){var e=new k(g.CLASS_TO_PLAIN,M(M({},V),n));return e.transform(void 0,t,void 0,void 0,void 0,void 0)},r.prototype.classToPlainFromExist=function(t,n,e){var o=new k(g.CLASS_TO_PLAIN,M(M({},V),e));return o.transform(n,t,void 0,void 0,void 0,void 0)},r.prototype.plainToInstance=function(t,n,e){var o=new k(g.PLAIN_TO_CLASS,M(M({},V),e));return o.transform(void 0,n,t,void 0,void 0,void 0)},r.prototype.plainToClassFromExist=function(t,n,e){var o=new k(g.PLAIN_TO_CLASS,M(M({},V),e));return o.transform(t,n,void 0,void 0,void 0,void 0)},r.prototype.instanceToInstance=function(t,n){var e=new k(g.CLASS_TO_CLASS,M(M({},V),n));return e.transform(void 0,t,void 0,void 0,void 0,void 0)},r.prototype.classToClassFromExist=function(t,n,e){var o=new k(g.CLASS_TO_CLASS,M(M({},V),e));return o.transform(n,t,void 0,void 0,void 0,void 0)},r.prototype.serialize=function(t,n){return JSON.stringify(this.instanceToPlain(t,n))},r.prototype.deserialize=function(t,n,e){var o=JSON.parse(n);return this.plainToInstance(t,o,e)},r.prototype.deserializeArray=function(t,n,e){var o=JSON.parse(n);return this.plainToInstance(t,o,e)},r}(),wt=new cn;function dt(r,t){return wt.instanceToPlain(r,t)}function ln(r,t,n){return wt.plainToInstance(r,t,n)}var Ot=function(){function r(t){this.groups=[],this.each=!1,this.context=void 0,this.type=t.type,this.target=t.target,this.propertyName=t.propertyName,this.constraints=t.constraints,this.constraintCls=t.constraintCls,this.validationTypeOptions=t.validationTypeOptions,t.validationOptions&&(this.message=t.validationOptions.message,this.groups=t.validationOptions.groups,this.always=t.validationOptions.always,this.each=t.validationOptions.each,this.context=t.validationOptions.context)}return r}(),pn=function(){function r(){}return r.prototype.transform=function(t){var n=[];return Object.keys(t.properties).forEach(function(e){t.properties[e].forEach(function(o){var i={message:o.message,groups:o.groups,always:o.always,each:o.each},s={type:o.type,target:t.name,propertyName:e,constraints:o.constraints,validationTypeOptions:o.options,validationOptions:i};n.push(new Ot(s))})}),n},r}();function dn(r){return r instanceof Map?Array.from(r.values()):Array.isArray(r)?r:Array.from(r)}function hn(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}function q(r){return r!==null&&typeof r=="object"&&typeof r.then=="function"}var At=function(){function r(){this.validationMetadatas=[],this.constraintMetadatas=[]}return Object.defineProperty(r.prototype,"hasValidationMetaData",{get:function(){return!!this.validationMetadatas.length},enumerable:!1,configurable:!0}),r.prototype.addValidationSchema=function(t){var n=this,e=new pn().transform(t);e.forEach(function(o){return n.addValidationMetadata(o)})},r.prototype.addValidationMetadata=function(t){this.validationMetadatas.push(t)},r.prototype.addConstraintMetadata=function(t){this.constraintMetadatas.push(t)},r.prototype.groupByPropertyName=function(t){var n={};return t.forEach(function(e){n[e.propertyName]||(n[e.propertyName]=[]),n[e.propertyName].push(e)}),n},r.prototype.getTargetValidationMetadatas=function(t,n,e,o,i){var s=function(f){return typeof f.always<"u"?f.always:f.groups&&f.groups.length?!1:e},u=function(f){return!!(o&&(!i||!i.length)&&f.groups&&f.groups.length)},l=this.validationMetadatas.filter(function(f){return f.target!==t&&f.target!==n?!1:s(f)?!0:u(f)?!1:i&&i.length>0?f.groups&&!!f.groups.find(function(c){return i.indexOf(c)!==-1}):!0}),a=this.validationMetadatas.filter(function(f){return typeof f.target=="string"||f.target===t||f.target instanceof Function&&!(t.prototype instanceof f.target)?!1:s(f)?!0:u(f)?!1:i&&i.length>0?f.groups&&!!f.groups.find(function(c){return i.indexOf(c)!==-1}):!0}),p=a.filter(function(f){return!l.find(function(c){return c.propertyName===f.propertyName&&c.type===f.type})});return l.concat(p)},r.prototype.getTargetValidatorConstraints=function(t){return this.constraintMetadatas.filter(function(n){return n.target===t})},r}();function X(){var r=hn();return r.classValidatorMetadataStorage||(r.classValidatorMetadataStorage=new At),r.classValidatorMetadataStorage}var J=function(){function r(){}return r.prototype.toString=function(t,n,e){var o=this;t===void 0&&(t=!1),n===void 0&&(n=!1),e===void 0&&(e="");var i=t?"\x1B[1m":"",s=t?"\x1B[22m":"",u=function(a){return" - property ".concat(i).concat(e).concat(a).concat(s," has failed the following constraints: ").concat(i).concat(Object.keys(o.constraints).join(", ")).concat(s,` 
`)};if(n){var l=Number.isInteger(+this.property)?"[".concat(this.property,"]"):"".concat(e?".":"").concat(this.property);return this.constraints?u(l):this.children?this.children.map(function(a){return a.toString(t,!0,"".concat(e).concat(l))}).join(""):""}else return"An instance of ".concat(i).concat(this.target?this.target.constructor.name:"an object").concat(s,` has failed the validation:
`)+(this.constraints?u(this.property):"")+(this.children?this.children.map(function(a){return a.toString(t,!0,o.property)}).join(""):"")},r}(),b=function(){function r(){}return r.isValid=function(t){var n=this;return t!=="isValid"&&t!=="getMessage"&&Object.keys(this).map(function(e){return n[e]}).indexOf(t)!==-1},r.CUSTOM_VALIDATION="customValidation",r.NESTED_VALIDATION="nestedValidation",r.PROMISE_VALIDATION="promiseValidation",r.CONDITIONAL_VALIDATION="conditionalValidation",r.WHITELIST="whitelistValidation",r.IS_DEFINED="isDefined",r}();function gn(r){return Array.isArray(r)?r.join(", "):"".concat(r)}var vn=function(){function r(){}return r.replaceMessageSpecialTokens=function(t,n){var e;return t instanceof Function?e=t(n):typeof t=="string"&&(e=t),e&&Array.isArray(n.constraints)&&n.constraints.forEach(function(o,i){e=e.replace(new RegExp("\\$constraint".concat(i+1),"g"),gn(o))}),e&&n.value!==void 0&&n.value!==null&&typeof n.value=="string"&&(e=e.replace(/\$value/g,n.value)),e&&(e=e.replace(/\$property/g,n.property)),e&&(e=e.replace(/\$target/g,n.targetName)),e},r}(),ht=function(){function r(t,n){this.validator=t,this.validatorOptions=n,this.awaitingPromises=[],this.ignoreAsyncValidations=!1,this.metadataStorage=X()}return r.prototype.execute=function(t,n,e){var o=this,i;!this.metadataStorage.hasValidationMetaData&&((i=this.validatorOptions)===null||i===void 0?void 0:i.enableDebugMessages)===!0&&console.warn("No metadata found. There is more than once class-validator version installed probably. You need to flatten your dependencies.");var s=this.validatorOptions?this.validatorOptions.groups:void 0,u=this.validatorOptions&&this.validatorOptions.strictGroups||!1,l=this.validatorOptions&&this.validatorOptions.always||!1,a=this.metadataStorage.getTargetValidationMetadatas(t.constructor,n,l,u,s),p=this.metadataStorage.groupByPropertyName(a);if(this.validatorOptions&&this.validatorOptions.forbidUnknownValues&&!a.length){var f=new J;(!this.validatorOptions||!this.validatorOptions.validationError||this.validatorOptions.validationError.target===void 0||this.validatorOptions.validationError.target===!0)&&(f.target=t),f.value=void 0,f.property=void 0,f.children=[],f.constraints={unknownValue:"an unknown value was passed to the validate function"},e.push(f);return}this.validatorOptions&&this.validatorOptions.whitelist&&this.whitelist(t,p,e),Object.keys(p).forEach(function(c){var E=t[c],T=p[c].filter(function(v){return v.type===b.IS_DEFINED}),I=p[c].filter(function(v){return v.type!==b.IS_DEFINED&&v.type!==b.WHITELIST});E instanceof Promise&&I.find(function(v){return v.type===b.PROMISE_VALIDATION})?o.awaitingPromises.push(E.then(function(v){o.performValidations(t,v,c,T,I,e)})):o.performValidations(t,E,c,T,I,e)})},r.prototype.whitelist=function(t,n,e){var o=this,i=[];Object.keys(t).forEach(function(s){(!n[s]||n[s].length===0)&&i.push(s)}),i.length>0&&(this.validatorOptions&&this.validatorOptions.forbidNonWhitelisted?i.forEach(function(s){var u,l=o.generateValidationError(t,t[s],s);l.constraints=(u={},u[b.WHITELIST]="property ".concat(s," should not exist"),u),l.children=void 0,e.push(l)}):i.forEach(function(s){return delete t[s]}))},r.prototype.stripEmptyErrors=function(t){var n=this;return t.filter(function(e){if(e.children&&(e.children=n.stripEmptyErrors(e.children)),Object.keys(e.constraints).length===0){if(e.children.length===0)return!1;delete e.constraints}return!0})},r.prototype.performValidations=function(t,n,e,o,i,s){var u=i.filter(function(c){return c.type===b.CUSTOM_VALIDATION}),l=i.filter(function(c){return c.type===b.NESTED_VALIDATION}),a=i.filter(function(c){return c.type===b.CONDITIONAL_VALIDATION}),p=this.generateValidationError(t,n,e);s.push(p);var f=this.conditionalValidations(t,n,a);!f||(this.customValidations(t,n,o,p),this.mapContexts(t,n,o,p),!(n===void 0&&this.validatorOptions&&this.validatorOptions.skipUndefinedProperties===!0)&&(n===null&&this.validatorOptions&&this.validatorOptions.skipNullProperties===!0||n==null&&this.validatorOptions&&this.validatorOptions.skipMissingProperties===!0||(this.customValidations(t,n,u,p),this.nestedValidations(n,l,p.children),this.mapContexts(t,n,i,p),this.mapContexts(t,n,u,p))))},r.prototype.generateValidationError=function(t,n,e){var o=new J;return(!this.validatorOptions||!this.validatorOptions.validationError||this.validatorOptions.validationError.target===void 0||this.validatorOptions.validationError.target===!0)&&(o.target=t),(!this.validatorOptions||!this.validatorOptions.validationError||this.validatorOptions.validationError.value===void 0||this.validatorOptions.validationError.value===!0)&&(o.value=n),o.property=e,o.children=[],o.constraints={},o},r.prototype.conditionalValidations=function(t,n,e){return e.map(function(o){return o.constraints[0](t,n)}).reduce(function(o,i){return o&&i},!0)},r.prototype.customValidations=function(t,n,e,o){var i=this;e.forEach(function(s){i.metadataStorage.getTargetValidatorConstraints(s.constraintCls).forEach(function(u){if(!(u.async&&i.ignoreAsyncValidations)&&!(i.validatorOptions&&i.validatorOptions.stopAtFirstError&&Object.keys(o.constraints||{}).length>0)){var l={targetName:t.constructor?t.constructor.name:void 0,property:s.propertyName,object:t,value:n,constraints:s.constraints};if(!s.each||!(Array.isArray(n)||n instanceof Set||n instanceof Map)){var a=u.instance.validate(n,l);if(q(a)){var p=a.then(function(h){if(!h){var S=i.createValidationError(t,n,s,u),O=S[0],y=S[1];o.constraints[O]=y,s.context&&(o.contexts||(o.contexts={}),o.contexts[O]=Object.assign(o.contexts[O]||{},s.context))}});i.awaitingPromises.push(p)}else if(!a){var f=i.createValidationError(t,n,s,u),c=f[0],E=f[1];o.constraints[c]=E}return}var T=dn(n),I=T.map(function(h){return u.instance.validate(h,l)}),v=I.some(function(h){return q(h)});if(v){var A=I.map(function(h){return q(h)?h:Promise.resolve(h)}),w=Promise.all(A).then(function(h){var S=h.every(function(z){return z});if(!S){var O=i.createValidationError(t,n,s,u),y=O[0],W=O[1];o.constraints[y]=W,s.context&&(o.contexts||(o.contexts={}),o.contexts[y]=Object.assign(o.contexts[y]||{},s.context))}});i.awaitingPromises.push(w);return}var x=I.every(function(h){return h});if(!x){var C=i.createValidationError(t,n,s,u),c=C[0],E=C[1];o.constraints[c]=E}}})})},r.prototype.nestedValidations=function(t,n,e){var o=this;t!==void 0&&n.forEach(function(i){var s;if(!(i.type!==b.NESTED_VALIDATION&&i.type!==b.PROMISE_VALIDATION))if(Array.isArray(t)||t instanceof Set||t instanceof Map){var u=t instanceof Set?Array.from(t):t;u.forEach(function(E,T){o.performValidations(t,E,T.toString(),[],n,e)})}else if(t instanceof Object){var l=typeof i.target=="string"?i.target:i.target.name;o.execute(t,l,e)}else{var a=new J;a.value=t,a.property=i.propertyName,a.target=i.target;var p=o.createValidationError(i.target,t,i),f=p[0],c=p[1];a.constraints=(s={},s[f]=c,s),e.push(a)}})},r.prototype.mapContexts=function(t,n,e,o){var i=this;return e.forEach(function(s){if(s.context){var u=void 0;if(s.type===b.CUSTOM_VALIDATION){var l=i.metadataStorage.getTargetValidatorConstraints(s.constraintCls);u=l[0]}var a=i.getConstraintType(s,u);o.constraints[a]&&(o.contexts||(o.contexts={}),o.contexts[a]=Object.assign(o.contexts[a]||{},s.context))}})},r.prototype.createValidationError=function(t,n,e,o){var i=t.constructor?t.constructor.name:void 0,s=this.getConstraintType(e,o),u={targetName:i,property:e.propertyName,object:t,value:n,constraints:e.constraints},l=e.message||"";!e.message&&(!this.validatorOptions||this.validatorOptions&&!this.validatorOptions.dismissDefaultMessages)&&o&&o.instance.defaultMessage instanceof Function&&(l=o.instance.defaultMessage(u));var a=vn.replaceMessageSpecialTokens(l,u);return[s,a]},r.prototype.getConstraintType=function(t,n){var e=n&&n.name?n.name:t.type;return e},r}(),yn=globalThis&&globalThis.__awaiter||function(r,t,n,e){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function u(p){try{a(e.next(p))}catch(f){s(f)}}function l(p){try{a(e.throw(p))}catch(f){s(f)}}function a(p){p.done?i(p.value):o(p.value).then(u,l)}a((e=e.apply(r,t||[])).next())})},Sn=globalThis&&globalThis.__generator||function(r,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,o,i,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(p){return l([a,p])}}function l(a){if(e)throw new TypeError("Generator is already executing.");for(;n;)try{if(e=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,o=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){n.label=a[1];break}if(a[0]===6&&n.label<i[1]){n.label=i[1],i=a;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(a);break}i[2]&&n.ops.pop(),n.trys.pop();continue}a=t.call(r,n)}catch(p){a=[6,p],o=0}finally{e=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},gt=function(){function r(){}return r.prototype.validate=function(t,n,e){return this.coreValidate(t,n,e)},r.prototype.validateOrReject=function(t,n,e){return yn(this,void 0,void 0,function(){var o;return Sn(this,function(i){switch(i.label){case 0:return[4,this.coreValidate(t,n,e)];case 1:return o=i.sent(),o.length?[2,Promise.reject(o)]:[2]}})})},r.prototype.validateSync=function(t,n,e){var o=typeof t=="string"?n:t,i=typeof t=="string"?e:n,s=typeof t=="string"?t:void 0,u=new ht(this,i);u.ignoreAsyncValidations=!0;var l=[];return u.execute(o,s,l),u.stripEmptyErrors(l)},r.prototype.coreValidate=function(t,n,e){var o=typeof t=="string"?n:t,i=typeof t=="string"?e:n,s=typeof t=="string"?t:void 0,u=new ht(this,i),l=[];return u.execute(o,s,l),Promise.all(u.awaitingPromises).then(function(){return u.stripEmptyErrors(l)})},r}(),mn=new(function(){function r(){this.instances=[]}return r.prototype.get=function(t){var n=this.instances.find(function(e){return e.type===t});return n||(n={type:t,object:new t},this.instances.push(n)),n.object},r}());function G(r){return mn.get(r)}var xn=function(){function r(t,n,e){e===void 0&&(e=!1),this.target=t,this.name=n,this.async=e}return Object.defineProperty(r.prototype,"instance",{get:function(){return G(this.target)},enumerable:!1,configurable:!0}),r}();function wn(r){var t;if(r.validator instanceof Function){t=r.validator;var n=G(At).getTargetValidatorConstraints(r.validator);if(n.length>1)throw"More than one implementation of ValidatorConstraintInterface found for validator on: ".concat(r.target.name,":").concat(r.propertyName)}else{var e=r.validator;t=function(){function i(){}return i.prototype.validate=function(s,u){return e.validate(s,u)},i.prototype.defaultMessage=function(s){return e.defaultMessage?e.defaultMessage(s):""},i}(),X().addConstraintMetadata(new xn(t,r.name,r.async))}var o={type:r.name&&b.isValid(r.name)?r.name:b.CUSTOM_VALIDATION,target:r.target,propertyName:r.propertyName,validationOptions:r.options,constraintCls:t,constraints:r.constraints};X().addValidationMetadata(new Ot(o))}function _t(r,t){return function(n){var e=t&&t.each?"each value in ":"";return r(e,n)}}function Mt(r,t){return function(n,e){wn({name:r.name,target:n.constructor,propertyName:e,options:t,constraints:r.constraints,validator:r.validator})}}var On="isInt";function An(r){return typeof r=="number"&&Number.isInteger(r)}function _n(r){return Mt({name:On,validator:{validate:function(t,n){return An(t)},defaultMessage:_t(function(t){return t+"$property must be an integer number"},r)}},r)}var Mn="isString";function En(r){return r instanceof String||typeof r=="string"}function Cn(r){return Mt({name:Mn,validator:{validate:function(t,n){return En(t)},defaultMessage:_t(function(t){return t+"$property must be a string"},r)}},r)}function bn(r,t,n){return typeof r=="string"?G(gt).validateSync(r,t,n):G(gt).validateSync(r,t)}const Tn=(r,t,n=!0)=>{const o=bt((()=>{const i=localStorage.getItem(t);if(!i)return null;try{const s=JSON.parse(i),u=ln(r,s),l=bn(u);if(l.length>0){if(n){const a=new r;l.forEach(p=>{const f=p.property;s[f]=a[f],localStorage.setItem(t,JSON.stringify(s))})}return n?s:null}return s}catch(s){return console.log(s),null}})()??dt(new r));return et(()=>o,mt(i=>{localStorage.setItem(t,JSON.stringify(i))},400,{trailing:!0}),{deep:!0}),{storage:o,reset:()=>{Object.assign(o,dt(new r))},clear(){localStorage.removeItem(t)}}};var In=Object.defineProperty,Nn=Object.getOwnPropertyDescriptor,Et=(r,t,n,e)=>{for(var o=e>1?void 0:e?Nn(t,n):t,i=r.length-1,s;i>=0;i--)(s=r[i])&&(o=(e?s(t,n,o):s(o))||o);return e&&o&&In(t,n,o),o};class it{constructor(){this.fontSize=14,this.fontFamily='"Helvetica Neue","Luxi Sans","DejaVu Sans","Hiragino Sans GB","Microsoft Yahei",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji","Segoe UI Symbol","Android Emoji","EmojiSymbols"'}}Et([_n()],it.prototype,"fontSize",2);Et([Cn()],it.prototype,"fontFamily",2);const Ln=L({props:{resetFn:{type:Function,required:!0}},setup(r){return()=>d(It,{trigger:"hover"},{trigger(){return d(Tt,{text:!0,class:"ml-2",onClick:()=>r.resetFn()},{default:()=>[d(K,{size:"20",class:"opacity-40 hover:opacity-100 transition-opacity duration-500"},{default:()=>[d(Jt,null,null)]})]})},default(){return"\u5C06\u4F1A\u91CD\u7F6E\u8FD9\u4E9B\u8BBE\u5B9A"}})}}),Pn={editor:"editor-pref",general:"editor-general"},kn=()=>{const{storage:r,reset:t}=Tn(it,Pn.general),n=L(()=>()=>d(Lt,null,[d(Nt,{class:"!flex items-center !mt-0"},{default:()=>[Q("\u901A\u7528\u8BBE\u7F6E"),d(Ln,{resetFn:t},null)]}),d(U,{label:"\u5B57\u4F53\u8BBE\u5B9A"},{default:()=>[d(vt,{onInput:e=>void(r.fontFamily=e),value:r.fontFamily},null)]}),d(U,{label:"\u5B57\u53F7\u8BBE\u5B9A"},{default:()=>[d(Ut,{onUpdateValue:e=>void(r.fontSize=e??14),value:r.fontSize},null)]}),d(U,{label:"\u6CE8\u610F: ",labelAlign:"right"},{default:()=>[d(yt,null,{default:()=>[Q("\u4EE5\u4E0A\u8BBE\u5B9A\u6682\u65F6\u4E0D\u9002\u4E8E Monaco Editor")]})]})]));return{general:{setting:r,resetSetting:t,Panel:n}}},Vn=()=>{const r=localStorage.getItem(xt.editor);if(!r)return null;try{const t=JSON.parse(r);return Object.keys(P).includes(t)?t:null}catch{return null}};let Y=!1;const Fn=L({props:{...rt,loading:{type:Boolean,required:!0}},setup(r){const t=Vn(),n=B(t??P.codemirror),e=B(!1),o=Pt(),i=B();ct(()=>{if(Y)return;const a=o.addFloatButton(d("button",{onClick:()=>{e.value=!0}},[d(K,{size:18},{default:()=>[d(en,null,null)]})])),p=o.addFloatButton(d("button",{onClick:()=>{i.value?.$el.requestFullscreen()}},[d(K,{size:18},{default:()=>[d(Qt,null,null)]})]));return Y=!0,()=>{o.removeFloatButton(a),o.removeFloatButton(p),Y=!1}}),ct(()=>{document.addEventListener("fullscreenchange",a=>{document.fullscreenElement===i.value?document.documentElement.classList.add("editor-fullscreen"):document.documentElement.classList.remove("editor-fullscreen")})}),et(()=>n.value,mt(a=>{localStorage.setItem(xt.editor,JSON.stringify(a))},300,{trailing:!0}));const s=B(),{general:u}=kn(),l=kt(()=>{if(r.loading)return d("div",{class:St($.editor,$.loading)},[d(j,{strokeWidth:14,show:!0,rotate:!0},null)]);switch(n.value){case"monaco":{const a=H(n.value);return d(a,zt({ref:s},r),null)}case"plain":{const a=H(n.value);return d(a,r,null)}case"codemirror":{const a=H(n.value);return d(a,r,null)}default:return null}});return()=>{const{Panel:a,setting:p}=u;return d(Vt,{tag:"div",style:{"--editor-font-size":p.fontSize?`${p.fontSize/14}rem`:"","--editor-font-family":p.fontFamily},class:"editor-wrapper",ref:i},{default:()=>[l.value,d(Bt,{transformOrigin:"center",show:e.value,onUpdateShow:f=>void(e.value=f)},{default:()=>[d(Dt,{closable:!0,onClose:()=>{e.value=!1},title:"\u7F16\u8F91\u5668\u8BBE\u5B9A",style:"max-width: 90vw;width: 500px; max-height: 65vh; overflow: auto",bordered:!1},{default:()=>[d(yt,{class:"text-center"},{default:()=>[d(jt,{depth:"3"},{default:()=>[Q("\u6B64\u8BBE\u5B9A\u4EC5\u5B58\u50A8\u5728\u672C\u5730!")]})]}),d($t,{labelPlacement:"left",labelWidth:"8rem",labelAlign:"right"},{default:()=>[d(U,{label:"\u7F16\u8F91\u5668\u9009\u62E9"},{default:()=>[d(Gt,{value:n.value,onUpdateValue:f=>void(n.value=f),options:Object.keys(P).map(f=>({key:f,label:f,value:f}))},null)]}),d(a,null,null)]})]})]})]})}}}),Bn=Z({loader:()=>Promise.resolve(Fn),loadingComponent:()=>d(j,{strokeWidth:14,show:!0,rotate:!0},null)}),Hn=L({props:{...rt,loading:{type:Boolean,required:!0}},setup(r){return()=>d(Ft,null,{default(){return d(Bn,r,null)},fallback(){return d("div",{class:St($.editor,$.loading)},[d(j,{strokeWidth:14,show:!0,rotate:!0},null)])}})}});export{Hn as E,Cn as I,lt as P,Mt as V,_t as b,rt as e,$ as s,Tn as u};
